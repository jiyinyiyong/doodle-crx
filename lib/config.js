// Generated by CoffeeScript 1.6.3
window.onload = function() {
  var config, q;
  try {
    config = JSON.parse(localStorage.getItem("config"));
  } catch (_error) {}
  if (!config) {
    config = {};
  }
  if (config.hostname == null) {
    config.hostname = "localhost";
  }
  if (config.port == null) {
    config.port = 7776;
  }
  q = function(query) {
    return document.querySelector(query);
  };
  console.log(config);
  q("#hostname").value = config.hostname;
  q("#port").value = config.port;
  q("#filter").value = config.filter;
  return window.onbeforeunload = function() {
    var data, filter, hostname, port;
    hostname = q("#hostname").value;
    port = parseInt(q("#port").value);
    filter = q("#filter").value;
    if ((hostname != null ? hostname.length : void 0) >= 4) {
      config.hostname = hostname;
    }
    if (typeof port === "number") {
      config.port = port;
    }
    config.filter = filter;
    localStorage.setItem("config", JSON.stringify(config));
    data = {
      update: {
        hostname: hostname,
        port: port
      }
    };
    return chrome.extension.sendRequest(data, function(ret) {
      return console.log(ret);
    });
  };
};
